#!/bin/sh
set -e

GIT_DIR='.git'

print_git_size() {
    HEADER=$1

    echo "$HEADER"
    du -h -d0 "$GIT_DIR"
}

if [ -d "$GIT_DIR" ]; then
  echo "âœ… $GIT_DIR found."
else
  echo "âŒ $GIT_DIR does not exist. Nothing to do here!"
  exit 1
fi

echo
print_git_size "âŒ›ï¸ Git directory size before:"

echo
echo "âŒ›ï¸ Cleanup start..."
git gc --aggressive --force
echo "Cleanup is finished"

echo
print_git_size "âŒ›ï¸ Git directory size after:"

echo
echo "ğŸ Done!"
